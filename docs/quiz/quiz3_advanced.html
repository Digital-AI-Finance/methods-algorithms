<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz 3: Advanced Topics | Methods &amp; Algorithms</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVuj4nkfMTmM/M/7EKJVGr6aSozTWXMEoxlNVlTqOgKHMJCnGZJ73Lpr/7Vdw" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Ber8i1e2fQs9/h7qJC/H6MXGLS8/3k0JzqfGJhZ" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxUvBOCaIpzhqKdQZnIJu5B6/HYJv9CrNR6xFZveLXHPmGIFV9O1e5sXD0J1c" crossorigin="anonymous"></script>
    <style>
        :root {
            --mlpurple: #3333B2;
            --mlblue: #0066CC;
            --quiz-accent: #3333B2;
            --quiz-light: #ADADE0;
            --correct: #22c55e;
            --incorrect: #ef4444;
            --bg: #f6f8fa;
            --card-bg: #ffffff;
            --text: #1e293b;
            --text-light: #64748b;
            --border: #e2e8f0;
            --radius: 12px;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; }
        .nav { background: linear-gradient(135deg, var(--mlpurple), var(--mlblue)); padding: 1rem 2rem; display: flex; align-items: center; justify-content: space-between; }
        .nav-title { color: white; font-size: 1.25rem; font-weight: 700; }
        .nav-links { display: flex; gap: 1.5rem; }
        .nav-links a { color: rgba(255,255,255,0.85); text-decoration: none; font-size: 0.9rem; font-weight: 500; }
        .nav-links a:hover { color: white; }
        .container { max-width: 900px; margin: 2rem auto; padding: 0 1.5rem; }
        .quiz-header { text-align: center; margin-bottom: 2rem; }
        .quiz-header h1 { font-size: 1.75rem; margin-bottom: 0.5rem; color: var(--mlpurple); }
        .quiz-header p { color: var(--text-light); margin-bottom: 1rem; }
        .stats { display: flex; gap: 0.75rem; justify-content: center; flex-wrap: wrap; }
        .stat-badge { background: var(--quiz-light); color: var(--mlpurple); padding: 0.35rem 0.85rem; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }
        .progress-wrap { background: var(--border); border-radius: 8px; height: 8px; margin-bottom: 2rem; overflow: hidden; }
        .progress-bar { height: 100%; background: linear-gradient(90deg, var(--mlpurple), var(--mlblue)); border-radius: 8px; transition: width 0.4s ease; width: 0%; }
        .questions-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.25rem; margin-bottom: 1.5rem; }
        @media (max-width: 768px) { .questions-row { grid-template-columns: 1fr; } }
        .question-card { background: var(--card-bg); border-radius: var(--radius); padding: 1.25rem; box-shadow: 0 1px 3px rgba(0,0,0,0.06); border: 1px solid var(--border); display: flex; flex-direction: column; }
        .question-num { font-size: 0.75rem; font-weight: 700; color: var(--quiz-accent); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 0.5rem; }
        .question-text { font-size: 0.95rem; font-weight: 600; margin-bottom: 1rem; line-height: 1.4; flex-grow: 1; }
        .options { display: flex; flex-direction: column; gap: 0.5rem; }
        .option { padding: 0.6rem 0.8rem; border: 1.5px solid var(--border); border-radius: 8px; cursor: pointer; font-size: 0.85rem; transition: all 0.2s; display: flex; align-items: flex-start; gap: 0.5rem; line-height: 1.35; }
        .option:hover:not(.disabled) { border-color: var(--quiz-accent); background: rgba(51,51,178,0.04); }
        .option.selected-correct { border-color: var(--correct); background: rgba(34,197,94,0.08); color: #166534; }
        .option.selected-incorrect { border-color: var(--incorrect); background: rgba(239,68,68,0.08); color: #991b1b; }
        .option.show-correct { border-color: var(--correct); background: rgba(34,197,94,0.08); }
        .option.disabled { cursor: default; opacity: 0.7; }
        .option-letter { font-weight: 700; min-width: 1.2rem; }
        .explanation { margin-top: 0.75rem; padding: 0.65rem; background: rgba(51,51,178,0.05); border-radius: 8px; font-size: 0.8rem; color: var(--text-light); line-height: 1.4; display: none; }
        .explanation.show { display: block; }
        .btn-row { text-align: center; margin-bottom: 2rem; }
        .btn { background: linear-gradient(135deg, var(--mlpurple), var(--mlblue)); color: white; border: none; padding: 0.75rem 2.5rem; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: opacity 0.2s; }
        .btn:hover { opacity: 0.9; }
        .btn:disabled { opacity: 0.4; cursor: default; }
        .results { background: var(--card-bg); border-radius: var(--radius); padding: 2rem; text-align: center; box-shadow: 0 1px 3px rgba(0,0,0,0.06); border: 1px solid var(--border); display: none; }
        .results h2 { font-size: 1.5rem; margin-bottom: 0.5rem; }
        .grade { font-size: 3rem; font-weight: 800; margin: 0.5rem 0; }
        .grade.a { color: var(--correct); } .grade.b { color: #65a30d; } .grade.c { color: #ca8a04; } .grade.d { color: #ea580c; } .grade.f { color: var(--incorrect); }
        .score-text { color: var(--text-light); font-size: 1.1rem; margin-bottom: 1rem; }
        .restart-btn { margin-top: 1rem; }
    </style>
</head>
<body>
    <nav class="nav">
        <span class="nav-title">Quiz 3: Advanced Topics</span>
        <div class="nav-links">
            <a href="../index.html">Dashboard</a>
            <a href="https://github.com/Digital-AI-Finance/methods-algorithms" target="_blank">GitHub</a>
        </div>
    </nav>
    <div class="container">
        <div class="quiz-header">
            <h1>Advanced Topics</h1>
            <p>L05 PCA &amp; t-SNE + L06 Embeddings &amp; Reinforcement Learning</p>
            <div class="stats">
                <span class="stat-badge">15 Questions</span>
                <span class="stat-badge">Multiple Choice</span>
                <span class="stat-badge" id="score-badge">Score: 0 / 0</span>
            </div>
        </div>
        <div class="progress-wrap"><div class="progress-bar" id="progress"></div></div>
        <div id="questions-container"></div>
        <div class="btn-row"><button class="btn" id="next-btn" disabled>Next</button></div>
        <div class="results" id="results">
            <h2>Quiz Complete!</h2>
            <div class="grade" id="grade"></div>
            <div class="score-text" id="final-score"></div>
            <button class="btn restart-btn" onclick="restart()">Try Again</button>
        </div>
    </div>

<script>
const questions = [
  {q:"What does Principal Component Analysis (PCA) maximize?", options:["Variance captured along each principal component","Distance between data points","Classification accuracy","Number of clusters in the data"], correct:0, explanation:"PCA finds directions that maximize variance in the data."},
  {q:"Which statement about principal components is correct?", options:["Principal components are orthogonal (uncorrelated) to each other","All principal components explain equal variance","Principal components are always aligned with original features","The number of principal components equals the number of samples"], correct:0, explanation:"PCs are eigenvectors of the covariance matrix and are mutually orthogonal."},
  {q:"A scree plot shows variance explained by each principal component. How do you choose the number of components to keep?", options:["Keep components before the \u201celbow\u201d where variance explained levels off","Always keep exactly half of the original features","Keep only the first component","Keep all components to avoid losing information"], correct:0, explanation:"The elbow indicates where additional components add little information."},
  {q:"Why should data be standardized (zero mean, unit variance) before applying PCA?", options:["To prevent features with larger scales from dominating the principal components","To make PCA run faster","To ensure principal components are positive","PCA only works on standardized data mathematically"], correct:0, explanation:"Without standardization, high-variance features dominate regardless of importance."},
  {q:"What is t-SNE primarily used for?", options:["Visualizing high-dimensional data in 2D or 3D while preserving local structure","Feature extraction for machine learning pipelines","Speeding up training of neural networks","Reconstructing original data from reduced dimensions"], correct:0, explanation:"t-SNE excels at revealing clusters and local patterns for visualization."},
  {q:"What does the perplexity parameter in t-SNE control?", options:["The effective number of neighbors considered for each point (local vs global focus)","The number of output dimensions","The convergence threshold","The random seed for reproducibility"], correct:0, explanation:"Perplexity balances attention between local and global data structure."},
  {q:"Which statement correctly compares PCA and t-SNE?", options:["PCA preserves global structure and variance; t-SNE preserves local neighborhood structure","t-SNE is always better than PCA for dimensionality reduction","PCA is non-linear; t-SNE is linear","Both methods produce the same results on any dataset"], correct:0, explanation:"PCA is linear and global; t-SNE is non-linear and local."},
  {q:"What problem do word embeddings (like Word2Vec) solve compared to one-hot encoding?", options:["They capture semantic similarity \u2013 similar words have similar vectors","They require less memory than one-hot encoding","They make text classification impossible","They convert words to binary values"], correct:0, explanation:"Embeddings place semantically similar words close together in vector space."},
  {q:"In the Skip-gram architecture of Word2Vec, what is the training objective?", options:["Predict surrounding context words given a target word","Predict a target word given its surrounding context words","Predict the next word in a sequence","Classify words into parts of speech"], correct:0, explanation:"Skip-gram uses the center word to predict its context neighbors."},
  {q:"Why is cosine similarity preferred over Euclidean distance for comparing word embeddings?", options:["Cosine similarity measures directional similarity regardless of vector magnitude","Cosine similarity is faster to compute","Euclidean distance cannot be computed for text data","Cosine similarity always returns positive values"], correct:0, explanation:"Direction captures semantic meaning better than magnitude in embeddings."},
  {q:"In reinforcement learning, what is the role of the \u201creward\u201d signal?", options:["It provides feedback on how good an action was in a given state","It determines what action the agent should take next","It specifies the next state after an action","It stores the agent's memory of past experiences"], correct:0, explanation:"Rewards guide the agent toward learning optimal behavior."},
  {q:"What does the Markov property state in a Markov Decision Process?", options:["The future state depends only on the current state and action, not on the history","All states must be visited at least once","Rewards must be positive","The agent must take random actions"], correct:0, explanation:"\u201cThe future is independent of the past given the present.\u201d"},
  {q:"In Q-learning, what does Q(s,a) represent?", options:["Expected cumulative reward from taking action a in state s and following optimal policy thereafter","Immediate reward for taking action a in state s","Probability of transitioning to the next state","Quality of the current state regardless of action"], correct:0, explanation:"Q-values estimate long-term value of state-action pairs."},
  {q:"In epsilon-greedy exploration, what does epsilon control?", options:["The probability of taking a random action instead of the greedy action","The learning rate for Q-value updates","The discount factor for future rewards","The number of neighbors to consider"], correct:0, explanation:"With probability epsilon, explore randomly; otherwise exploit the best known action."},
  {q:"What happens when the discount factor gamma is close to 0 in reinforcement learning?", options:["The agent becomes \u201cmyopic\u201d \u2013 prioritizing immediate rewards over future rewards","The agent explores more","Learning becomes faster","The agent considers infinite future time steps equally"], correct:0, explanation:"Low gamma heavily discounts future rewards, focusing on immediate gains."}
];

questions.forEach(q => {
    const correctText = q.options[q.correct];
    for (let i = q.options.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [q.options[i], q.options[j]] = [q.options[j], q.options[i]];
    }
    q.correct = q.options.indexOf(correctText);
});

const BATCH = 3;
let currentBatch = 0, score = 0, answered = 0, answeredInBatch = 0;

function render() {
    const container = document.getElementById('questions-container');
    container.innerHTML = '';
    const start = currentBatch * BATCH, end = Math.min(start + BATCH, questions.length);
    const row = document.createElement('div');
    row.className = 'questions-row';
    for (let i = start; i < end; i++) {
        const q = questions[i];
        const card = document.createElement('div');
        card.className = 'question-card';
        card.innerHTML = `<div class="question-num">Question ${i+1} of ${questions.length}</div><div class="question-text">${q.q}</div><div class="options">${q.options.map((o,j) => `<div class="option" data-q="${i}" data-o="${j}"><span class="option-letter">${'ABCD'[j]}.</span><span>${o}</span></div>`).join('')}</div><div class="explanation" id="exp-${i}">${q.explanation}</div>`;
        row.appendChild(card);
    }
    container.appendChild(row);
    answeredInBatch = 0;
    updateBtn();
    document.querySelectorAll('.option').forEach(el => el.addEventListener('click', handleClick));
}

function handleClick(e) {
    const opt = e.currentTarget, qi = +opt.dataset.q, oi = +opt.dataset.o;
    const siblings = document.querySelectorAll(`.option[data-q="${qi}"]`);
    if ([...siblings].some(s => s.classList.contains('disabled'))) return;
    siblings.forEach(s => s.classList.add('disabled'));
    const correct = questions[qi].correct;
    if (oi === correct) { opt.classList.add('selected-correct'); score++; }
    else { opt.classList.add('selected-incorrect'); siblings[correct].classList.add('show-correct'); }
    document.getElementById(`exp-${qi}`).classList.add('show');
    answered++; answeredInBatch++;
    document.getElementById('score-badge').textContent = `Score: ${score} / ${answered}`;
    document.getElementById('progress').style.width = (answered/questions.length*100)+'%';
    updateBtn();
}

function updateBtn() {
    const btn = document.getElementById('next-btn');
    const batchSize = Math.min(BATCH, questions.length - currentBatch*BATCH);
    btn.disabled = answeredInBatch < batchSize;
    btn.textContent = (currentBatch+1)*BATCH >= questions.length ? 'See Results' : 'Next';
}

document.getElementById('next-btn').addEventListener('click', () => {
    if ((currentBatch+1)*BATCH >= questions.length) { showResults(); return; }
    currentBatch++; render(); window.scrollTo({top:0,behavior:'smooth'});
});

function showResults() {
    document.getElementById('questions-container').style.display='none';
    document.querySelector('.btn-row').style.display='none';
    const pct = score/questions.length*100;
    let g,c; if(pct>=90){g='A';c='a';}else if(pct>=80){g='B';c='b';}else if(pct>=70){g='C';c='c';}else if(pct>=60){g='D';c='d';}else{g='F';c='f';}
    document.getElementById('grade').textContent=g;
    document.getElementById('grade').className='grade '+c;
    document.getElementById('final-score').textContent=`${score} out of ${questions.length} correct (${Math.round(pct)}%)`;
    document.getElementById('results').style.display='block';
}

function restart() {
    score=0;answered=0;currentBatch=0;
    questions.forEach(q=>{const ct=q.options[q.correct];for(let i=q.options.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[q.options[i],q.options[j]]=[q.options[j],q.options[i]];}q.correct=q.options.indexOf(ct);});
    document.getElementById('questions-container').style.display='';
    document.querySelector('.btn-row').style.display='';
    document.getElementById('results').style.display='none';
    document.getElementById('score-badge').textContent='Score: 0 / 0';
    document.getElementById('progress').style.width='0%';
    render();
}

function renderMath() {
    if (typeof renderMathInElement !== 'undefined') {
        renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });
    }
}

function waitForKaTeX(callback, maxAttempts = 50) {
    let attempts = 0;
    function check() {
        if (typeof renderMathInElement !== 'undefined') {
            callback();
        } else if (attempts < maxAttempts) {
            attempts++;
            setTimeout(check, 50);
        }
    }
    check();
}

// Initialize with error handling
try {
    render();
    waitForKaTeX(renderMath);
} catch (e) {
    console.error('Quiz initialization error:', e);
    document.getElementById('questions-container').innerHTML =
        '<div style="padding:2rem;text-align:center;color:#991b1b;">' +
        '<h3>Quiz failed to load</h3><p>Error: ' + e.message + '</p>' +
        '<p>Please refresh the page or try a different browser.</p></div>';
}
</script>
</body>
</html>
